#### Тестовое задание на позицию UnityDeveloper.
### **Задание:** 
+ **1. Сцена**
  + **1.1.** - игровое поле это сетка из квадратных ячеек.
  + **1.2.** - игровое поле бесконечно.
  + **1.3.** - когда игрок возвращается на позицию, где был ранее, объекты сохраняют своё первоначальное местоположение.
  + **1.4.** - ячейка на игрвом поле заполниется либо ничем, либо планетой.
  + **1.5.** - 30% ячеек игрового поля, заполнены планетами.
+ **2. Игрок:**
  + **2.1.** - игрок это космичксий корабль.
  + **2.2.** - при появлении игрока на сцене, ему присвается случайный рейтинг от 0 до 10000.
+ **3. Планета:**
  + **3.1.** - при повялении планеты на игровом поле, ей присвается случайный рейтинг от 0 до 10000.
  + **3.2.** - рейтинг планеты выводится рядом с ней.
+ **4. Передвижение:**
  + **4.1.** - передвижение происходит мгновенно.
  + **4.2.** - при нажатий на одну из клавиш WASD игрок передвигается.
+ **5. Зум:**
  + **5.1.** - отдаление или приближение камеры осуществляется с помощью вращения колёсика мыши.
  + **5.2.** - минимальная область видимости NxN ячеек, где N = 5.
  + **5.3.** - максимальная область видимости NxN ячеек, где N = 10000.
  + **5.4.** - при значении N = 10, включается специальный режим.
  + **5.5.** - в специальном режиме видны только 20 планет в зоне видимости игрока.
  + **5.6.** - планеты в специальном режиме масштабируются в зависимости от отдаления камеры.

### **Реализация:** 
[Короткое видео]()
+ **1. Генерация карты:**

![UML](https://user-images.githubusercontent.com/107647367/225294431-1eb76e52-f2a1-4dcf-a7e6-1c9ad4806f4f.png)

  При старте игры, GameController прокидывает в WorldGenerator необходимые настройки ChunkSpawner и NearestPlanetController. WorldGenerator обрабатывает полученые данные и отправляет их в ChunkSpawner для генерации модели чаноков, которые содержат в себе модели планет(Чанк - это область на карте, по умолчанию выставленная в 100 ячеек, которая содержит в себе список планет в размере 30 штук(количество планет в чанке настраиваемое через редактор)). После генерации чанков, WorldGenerator прокидывает их в NearestPlanetController для дальнейшей обработки. Более WorldGenerator не используется. Он необходим для разгрузки GameController.

+ **2. Обработка пользовательского ввода:**

![UML](https://user-images.githubusercontent.com/107647367/225298993-b5268868-9911-48bf-ae2a-e9977fb0b2e3.png)

  При нажатиие на одну из клавиш WASD PlayerInput ловит значение с нажатых клавишь и передаёт их значение в PlayerMovemet, он же в свою очередь определяет, куда игрок должен передвинуться. При использовании колёсика мыши, PlayerInput передаёт его значение в PlayerScroller, он же обрабатывет значение и передаёт его в камеру.

+ **3. Сортировка планет:**

![UML](https://user-images.githubusercontent.com/107647367/225299964-db0b1cbc-f19d-478f-b803-a8947e9a0b2c.png)

  При генерации нового чанка, пробрасывается событие вместе с которым передаётся информация о новом чанке в EventBus, после чего PlanetSorter получает информацию о новом чанке и сортирует новые данные для дальнейшей обработки.

+ **4. Отображение планет:**

![UML](https://user-images.githubusercontent.com/107647367/225301527-87308a25-9721-4226-ad6a-0dce00e24a1a.png)

  В Зависимости от режима, GameController передаёт данные в один из контроллеров (NearestPlanetsController или NearestChunkController), те в сою очередь обрабатывают полученные данные и прокидывают их в PoolController, он вычищается из пула старые данных и используя новополученные передаёт значение в PlanetView и включает их на сцене с новыми данными. Таким образом на сцене никогда не будет объектов больше, чем было передано в начале игры GameController(В данном случае это 270 обектов, для 9 чанков размером 10x10, по 30 планет в каждом. Это значение можно сделать меньше или больше перед стартом игровой сессии).

+ **5. Контроль мода отображения:**

![UML](https://user-images.githubusercontent.com/107647367/225303392-066bbb98-7007-4d28-8bba-b3190714366a.png)

  В зависимости от зума камеры PlayerScroller передаёт ивент в GameController через EventBus. GameController же в зависимости от полученной информации принимает решение, какой из контроллеров будет обрабатывать вид в игре. NearestPlanetsController отображает ближашие планеты в специальном режиме отображения. NearestChunkController отображает ближайшие чанки в обычном режиме отображения.

+ **6. Обычный режим отображения:**

  Получает из GameController индекс позиции игрока и словарь со всеми чанками на сцене, ищет ближайшие 9 чанков относительно игрока и передаёт информацию в PoolController.

+ **7. Специальный режим отображения:**

  Получает из GameController позицию игрока и его область видимости, после чего передаёт эту инормацию в PlanetSorter и в ответ получает список из 20 ближайших планет по рейтингу, относительно игрока (количество ближайших планет изменяемое). Полученню информацию делегирует в PoolController.
